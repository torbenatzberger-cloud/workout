<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>ATZ Training</title>
    <style>
        :root { --primary: #007AFF; --bg: #121212; --card: #1E1E1E; --text: #FFFFFF; --green: #32D74B; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* Screens */
        .screen { display: none; height: 100%; flex-direction: column; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        .active { display: flex; }

        /* Start Screen */
        h1 { text-align: center; margin-bottom: 30px; font-size: 24px; letter-spacing: 1px; text-transform: uppercase; color: var(--primary); }
        .menu-btn { background: var(--card); color: white; border: 1px solid #333; padding: 25px; margin-bottom: 15px; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; text-align: left; display: flex; justify-content: space-between; align-items: center; transition: background 0.2s; }
        .menu-btn:active { background: #333; }
        .menu-btn span { color: #888; font-size: 14px; font-weight: normal; }

        /* Workout Screen */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .back-btn { background: none; border: none; color: #888; font-size: 14px; cursor: pointer; }
        .exercise-title { font-size: 20px; font-weight: bold; margin: 10px 0; }
        .exercise-meta { color: #888; font-size: 14px; margin-bottom: 15px; }
        
        .img-container { width: 100%; height: 200px; background: #000; display: flex; align-items: center; justify-content: center; border-radius: 8px; margin-bottom: 20px; overflow: hidden; border: 1px solid #333; }
        .img-container img { max-width: 100%; max-height: 100%; object-fit: contain; }

        .stats-box { background: var(--card); padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #333; }
        .last-stats { font-size: 13px; color: #aaa; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px; }
        
        .input-row { display: flex; gap: 10px; align-items: center; }
        .input-group { flex: 1; display: flex; flex-direction: column; }
        .input-group label { font-size: 12px; color: #888; margin-bottom: 5px; }
        input[type="number"] { background: #333; border: none; color: white; padding: 15px; border-radius: 8px; font-size: 20px; text-align: center; width: 100%; box-sizing: border-box; }
        
        .action-btn { background: var(--primary); color: white; border: none; padding: 20px; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: auto; width: 100%; }
        .action-btn.finish { background: var(--green); color: black; }

        /* Timer Overlay */
        #timerOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 100; }
        .timer-circle { width: 200px; height: 200px; border-radius: 50%; border: 5px solid var(--primary); display: flex; justify-content: center; align-items: center; font-size: 60px; font-weight: bold; margin-bottom: 40px; }
        .skip-btn { background: transparent; border: 1px solid #555; color: white; padding: 10px 30px; border-radius: 20px; font-size: 16px; }

    </style>
</head>
<body>

    <div id="startScreen" class="screen active">
        <h1>ATZ Trainingsplan</h1>
        <button class="menu-btn" onclick="startWorkout('A')">KRAFT A <span>Beine + Core</span></button>
        <button class="menu-btn" onclick="startWorkout('B')">KRAFT B <span>Oberkörper Push</span></button>
        <button class="menu-btn" onclick="startWorkout('C')">KRAFT C <span>Rücken + Arme</span></button>
    </div>

    <div id="workoutScreen" class="screen">
        <div class="header">
            <button class="back-btn" onclick="goHome()">Abbrechen</button>
            <div id="progressText">Übung 1/8</div>
        </div>

        <div class="exercise-title" id="exName">Exercise Name</div>
        <div class="exercise-meta" id="exMeta">3 Sätze • 8-12 Whd</div>

        <div class="img-container">
            <img id="exImage" src="" alt="Übung">
        </div>

        <div class="stats-box">
            <div class="last-stats" id="lastStats">Zuletzt: Noch keine Daten</div>
            <div class="input-row">
                <div class="input-group">
                    <label>Gewicht (kg)</label>
                    <input type="number" id="weightInput" inputmode="decimal" placeholder="0">
                </div>
                <div class="input-group">
                    <label>Wdh.</label>
                    <input type="number" id="repsInput" inputmode="numeric" placeholder="0">
                </div>
            </div>
        </div>

        <button class="action-btn" id="mainBtn" onclick="finishSet()">Satz fertig</button>
    </div>

    <div id="timerOverlay">
        <div class="timer-circle" id="timerDisplay">90</div>
        <button class="skip-btn" onclick="stopTimer()">Pause überspringen</button>
    </div>

    <script>
        // DATEN (Updated for PNG images)
        const workouts = {
            "A": {
                name: "Kraft A (Beine + Core)",
                exercises: [
                    { id: "squats", name: "Squats (Goblet)", sets: 3, range: "15-20", img: "squats.png" },
                    { id: "lunges", name: "Lunges", sets: 3, range: "8-12 pro Seite", img: "lunges.png" },
                    { id: "hip_raise", name: "Hip Raise", sets: 3, range: "12-20", img: "hip_raise.png" },
                    { id: "calf_raise", name: "Calf Raise", sets: 2, range: "30", img: "calf_raise.png" },
                    { id: "situps", name: "Butterfly Sit-Ups", sets: 3, range: "12-20", img: "situps.png" },
                    { id: "leg_raises", name: "Leg Raises", sets: 3, range: "10-15", img: "leg_raises.png" },
                    { id: "side_plank", name: "Side Plank Crunch", sets: 3, range: "10-15 p.S.", img: "side_plank.png" },
                    { id: "snow_angel", name: "Snow Angel", sets: 3, range: "20", img: "snow_angel.png" }
                ]
            },
            "B": {
                name: "Kraft B (Push)",
                exercises: [
                    { id: "shrugs", name: "Shrugs", sets: 3, range: "20", img: "shrugs.png" },
                    { id: "lateral_raise", name: "Lateral Raise", sets: 3, range: "8-12", img: "lateral_raise.png" },
                    { id: "front_raise", name: "Front Raise", sets: 3, range: "8-12", img: "front_raise.png" },
                    { id: "shoulder_press", name: "Shoulder Press", sets: 3, range: "8-12", img: "shoulder_press.png" },
                    { id: "chest_fly", name: "Chest Fly", sets: 3, range: "8-12", img: "chest_fly.png" },
                    { id: "chest_press", name: "Chest/Hammer Press", sets: 3, range: "8-12", img: "chest_press.png" },
                    { id: "pushups", name: "Push-Ups", sets: 3, range: "8-12", img: "pushups.png" },
                    { id: "spider_pushups", name: "Spider Push-Ups", sets: 3, range: "5/5", img: "spider_pushups.png" },
                    { id: "leg_raises", name: "Finisher: Leg Raises", sets: 1, range: "20-30 Sek", img: "leg_raises.png" },
                    { id: "side_plank", name: "Finisher: Side Plank", sets: 1, range: "20-30 Sek", img: "side_plank.png" }
                ]
            },
            "C": {
                name: "Kraft C (Rücken + Arme)",
                exercises: [
                    { id: "deadlifts", name: "Deadlifts", sets: 3, range: "8-12", img: "deadlifts.png" },
                    { id: "reverse_flys", name: "Reverse Flys", sets: 3, range: "8-12", img: "reverse_flys.png" },
                    { id: "single_arm_row", name: "Single Arm Row", sets: 3, range: "8-12", img: "single_arm_row.png" },
                    { id: "biceps_curls", name: "Biceps Curls", sets: 3, range: "8-12", img: "biceps_curls.png" },
                    { id: "bent_over_row", name: "Bent-Over Row", sets: 3, range: "8-12", img: "bent_over_row.png" }
                ]
            }
        };

        // STATE
        let currentPlan = null;
        let currentExIndex = 0;
        let currentSet = 1;
        let timerInterval = null;

        // DOM ELEMENTS
        const startScreen = document.getElementById('startScreen');
        const workoutScreen = document.getElementById('workoutScreen');
        const timerOverlay = document.getElementById('timerOverlay');
        const timerDisplay = document.getElementById('timerDisplay');
        const weightInput = document.getElementById('weightInput');
        const repsInput = document.getElementById('repsInput');

        function startWorkout(planId) {
            currentPlan = workouts[planId];
            currentExIndex = 0;
            currentSet = 1;
            startScreen.classList.remove('active');
            workoutScreen.classList.add('active');
            loadExercise();
        }

        function loadExercise() {
            const ex = currentPlan.exercises[currentExIndex];
            
            document.getElementById('exName').innerText = ex.name;
            document.getElementById('exMeta').innerText = `${ex.sets} Sätze • Ziel: ${ex.range}`;
            document.getElementById('progressText').innerText = `Übung ${currentExIndex + 1}/${currentPlan.exercises.length} • Satz ${currentSet}/${ex.sets}`;
            document.getElementById('exImage').src = ex.img;
            
            // Button Reset
            const btn = document.getElementById('mainBtn');
            btn.innerText = "Satz fertig";
            btn.classList.remove('finish');
            btn.onclick = finishSet;

            // Load History
            const history = JSON.parse(localStorage.getItem(`atz_${ex.id}`)) || [];
            const lastSession = history.length > 0 ? history[history.length - 1] : null;

            if (lastSession) {
                document.getElementById('lastStats').innerText = `Zuletzt: ${lastSession.weight}kg × ${lastSession.reps} Wdh.`;
                // Auto-fill values
                weightInput.value = lastSession.weight;
                repsInput.value = lastSession.reps;
            } else {
                document.getElementById('lastStats').innerText = "Zuletzt: Noch keine Daten";
                weightInput.value = "";
                repsInput.value = "";
            }
        }

        function finishSet() {
            const ex = currentPlan.exercises[currentExIndex];
            const w = weightInput.value;
            const r = repsInput.value;

            // Save Data
            if(w && r) {
                const history = JSON.parse(localStorage.getItem(`atz_${ex.id}`)) || [];
                history.push({ date: new Date().toISOString(), weight: w, reps: r });
                // Keep only last 10 entries to save space
                if(history.length > 20) history.shift(); 
                localStorage.setItem(`atz_${ex.id}`, JSON.stringify(history));
            }

            // Logic for Next Set/Exercise
            if (currentSet < ex.sets) {
                currentSet++;
                startTimer(90); // 90 Sek Pause
            } else {
                // Exercise Finished
                if (currentExIndex < currentPlan.exercises.length - 1) {
                    currentExIndex++;
                    currentSet = 1;
                    startTimer(90); // Pause auch beim Übungswechsel
                } else {
                    // Workout Finished
                    alert("Training beendet! Stark gemacht.");
                    goHome();
                }
            }
        }

        function startTimer(seconds) {
            let timeLeft = seconds;
            timerOverlay.style.display = 'flex';
            timerDisplay.innerText = timeLeft;
            
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.innerText = timeLeft;
                if (timeLeft <= 0) {
                    stopTimer();
                }
            }, 1000);
        }

        function stopTimer() {
            clearInterval(timerInterval);
            timerOverlay.style.display = 'none';
            loadExercise(); // Reload UI for next set/exercise
        }

        function goHome() {
            workoutScreen.classList.remove('active');
            startScreen.classList.add('active');
        }

    </script>
</body>
</html>
